---
title: '@arcblock/swap-storage-mongo'
description: 'Storage engine that uses mongodb for atomic swap'
keywords: 'forge, sdk, javascript'
author: 'wangshijun'
category: 'packages'
layout: 'documentation'
tags:
  - 'forge'
---


## MongoSwapStorage

**Kind**: global class  

* [MongoSwapStorage](#MongoSwapStorage)
  * [new MongoSwapStorage(options)](#new_MongoSwapStorage_new)
  * [create(traceId, initialAttributes)](#MongoSwapStorage+create) ⇒ `Promise.<object>`
  * [read(traceId)](#MongoSwapStorage+read) ⇒ `Promise.<object>`
  * [finalize(traceId, payload)](#MongoSwapStorage+finalize) ⇒ `Promise.<object>`
  * [update(traceId, updates)](#MongoSwapStorage+update) ⇒ `Promise.<object>`
  * [delete(traceId)](#MongoSwapStorage+delete) ⇒
  * [listByStatus(status)](#MongoSwapStorage+listByStatus) ⇒ `Promise.<Array>`
  * [listByOfferAddress(address, \[status\])](#MongoSwapStorage+listByOfferAddress) ⇒ `Promise.<Array>`
  * [listByDemandAddress(address, \[status\])](#MongoSwapStorage+listByDemandAddress) ⇒ `Promise.<Array>`

### new MongoSwapStorage(options)

Creates an instance of MongoSwapStorage.

| Param                | Type     | Default                                     | Description                                |
| -------------------- | -------- | ------------------------------------------- | ------------------------------------------ |
| options              | `Object` |                                             | { collection, url }                        |
| options.url          | `string` |                                             | mongodb connection string                  |
| [options.collection] | `string` | `&quot;&#x27;forge_swap_orders&#x27;&quot;` | which collection to store the swap records |

### mongoSwapStorage.create(traceId, initialAttributes) ⇒ `Promise.<object>`

Create new atomic-swap order, traceId should be generated by user

**Kind**: instance method of [`MongoSwapStorage`](#MongoSwapStorage)  

| Param             | Type     |
| ----------------- | -------- |
| traceId           | `string` |
| initialAttributes | `object` |

### mongoSwapStorage.read(traceId) ⇒ `Promise.<object>`

Get an atomic-swap order by traceId

**Kind**: instance method of [`MongoSwapStorage`](#MongoSwapStorage)  
**Returns**: `Promise.<object>` - the atomic-swap-order  

| Param   | Type     | Description                |
| ------- | -------- | -------------------------- |
| traceId | `string` | the uuid of the swap order |

### mongoSwapStorage.finalize(traceId, payload) ⇒ `Promise.<object>`

Finalize the payload of atomic-swap

**Kind**: instance method of [`MongoSwapStorage`](#MongoSwapStorage)  

| Param   | Type     |
| ------- | -------- |
| traceId | `string` |
| payload | `object` |

### mongoSwapStorage.update(traceId, updates) ⇒ `Promise.<object>`

Update the status of an atomic-swap order, will not allow payload fields to be updated

**Kind**: instance method of [`MongoSwapStorage`](#MongoSwapStorage)  

| Param   | Type     |
| ------- | -------- |
| traceId | `string` |
| updates | `object` |

### mongoSwapStorage.delete(traceId) ⇒

Delete atomic swap order by traceId

**Kind**: instance method of [`MongoSwapStorage`](#MongoSwapStorage)  
**Returns**: void  

| Param   | Type     |
| ------- | -------- |
| traceId | `string` |

### mongoSwapStorage.listByStatus(status) ⇒ `Promise.<Array>`

Find atomic swap records by status

**Kind**: instance method of [`MongoSwapStorage`](#MongoSwapStorage)  
**Returns**: `Promise.<Array>` - TODO: add pagination for this  

| Param  | Type     | Description                             |
| ------ | -------- | --------------------------------------- |
| status | `string` | check out list of supported status here |

### mongoSwapStorage.listByOfferAddress(address, [status]) ⇒ `Promise.<Array>`

Find atomic swap records by offer address and status

**Kind**: instance method of [`MongoSwapStorage`](#MongoSwapStorage)  
**Returns**: `Promise.<Array>` - TODO: add pagination for this  

| Param    | Type     | Default                    |
| -------- | -------- | -------------------------- |
| address  | `string` |                            |
| [status] | `string` | `&quot;&#x27;&#x27;&quot;` |

### mongoSwapStorage.listByDemandAddress(address, [status]) ⇒ `Promise.<Array>`

Find atomic swap records by demand address and status

**Kind**: instance method of [`MongoSwapStorage`](#MongoSwapStorage)  
**Returns**: `Promise.<Array>` - TODO: add pagination for this  

| Param    | Type     | Default                    |
| -------- | -------- | -------------------------- |
| address  | `string` |                            |
| [status] | `string` | `&quot;&#x27;&#x27;&quot;` |


## Contributors

| Name           | Website                    |
| -------------- | -------------------------- |
| **wangshijun** | <https://ocap.arcblock.io> |

  